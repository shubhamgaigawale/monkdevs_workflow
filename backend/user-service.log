
  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
[32m :: Spring Boot :: [39m              [2m (v3.2.1)[0;39m

22:45:09.261 [main] INFO  c.c.u.UserServiceApplication - Starting UserServiceApplication using Java 23.0.2 with PID 75514 (/Users/shubhamgaigawale/monkdevs_workflow/backend/user-service/target/user-service-1.0.0.jar started by shubhamgaigawale in /Users/shubhamgaigawale/monkdevs_workflow/backend)
22:45:09.263 [main] DEBUG c.c.u.UserServiceApplication - Running with Spring Boot v3.2.1, Spring v6.1.2
22:45:09.264 [main] INFO  c.c.u.UserServiceApplication - No active profile set, falling back to 1 default profile: "default"
22:45:10.794 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
22:45:10.795 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
22:45:10.904 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 103 ms. Found 4 JPA repository interfaces.
22:45:10.919 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
22:45:10.919 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
22:45:10.939 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.crm.userservice.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
22:45:10.939 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.crm.userservice.repository.PermissionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
22:45:10.939 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.crm.userservice.repository.RoleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
22:45:10.939 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.crm.userservice.repository.TenantRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
22:45:10.939 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
22:45:12.005 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
22:45:12.012 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
22:45:12.012 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.17]
22:45:12.037 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
22:45:12.039 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2651 ms
22:45:12.550 [main] INFO  o.f.c.i.s.classpath.ClassPathScanner - Flyway OSS Edition 10.4.1 by Redgate
22:45:12.550 [main] INFO  o.f.c.i.s.classpath.ClassPathScanner - 
22:45:12.550 [main] INFO  o.f.c.i.s.classpath.ClassPathScanner - See release notes here: https://rd.gt/416ObMi
22:45:12.555 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
22:45:12.850 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@4a9869a8
22:45:12.851 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
22:45:12.887 [main] INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/crm_db (PostgreSQL 15.15)
22:45:12.940 [main] INFO  o.f.core.internal.command.DbValidate - Successfully validated 1 migration (execution time 00:00.028s)
22:45:12.971 [main] INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 1
22:45:12.975 [main] INFO  o.f.core.internal.command.DbMigrate - Schema "public" is up to date. No migration necessary.
22:45:13.143 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
22:45:13.215 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.1.Final
22:45:13.272 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
22:45:13.482 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
22:45:13.522 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
22:45:14.139 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
22:45:14.191 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
22:45:14.489 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
22:45:15.875 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
22:45:15.930 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: d08e2e8b-d53a-4df0-bcac-ae0642de1032

This generated password is for development use only. Your security configuration must be updated before running your application in production.

22:45:16.388 [main] INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@3b07b706, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@3b76dfa6, org.springframework.security.web.context.SecurityContextHolderFilter@2ecb7f0c, org.springframework.security.web.header.HeaderWriterFilter@34723cfe, org.springframework.web.filter.CorsFilter@7b4185ea, org.springframework.security.web.authentication.logout.LogoutFilter@7080e8fc, com.crm.common.security.filter.JwtAuthenticationFilter@2b43f314, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@3e51beda, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@51bab787, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@196bc2c1, org.springframework.security.web.session.SessionManagementFilter@33116b8e, org.springframework.security.web.access.ExceptionTranslationFilter@34018757, org.springframework.security.web.access.intercept.AuthorizationFilter@3f07eede]
22:45:17.138 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/api'
22:45:17.162 [main] INFO  c.c.u.UserServiceApplication - Started UserServiceApplication in 8.352 seconds (process running for 8.999)
22:45:47.478 [http-nio-8081-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
22:45:47.478 [http-nio-8081-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
22:45:47.479 [http-nio-8081-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
22:45:47.486 [http-nio-8081-exec-1] DEBUG o.s.security.web.FilterChainProxy - Securing POST /auth/login
22:45:47.489 [http-nio-8081-exec-1] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
22:45:47.489 [http-nio-8081-exec-1] DEBUG o.s.security.web.FilterChainProxy - Secured POST /auth/login
22:45:47.527 [http-nio-8081-exec-1] INFO  c.c.u.controller.AuthController - Login request for email: admin@acme.com
22:45:47.532 [http-nio-8081-exec-1] INFO  c.c.userservice.service.AuthService - Login attempt for email: admin@acme.com
22:45:47.565 [http-nio-8081-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.is_active,
        u1_0.last_login,
        u1_0.last_name,
        u1_0.password_hash,
        u1_0.phone,
        u1_0.tenant_id,
        u1_0.updated_at 
    from
        user_management.users u1_0 
    where
        u1_0.email=?
22:45:47.576 [http-nio-8081-exec-1] DEBUG org.hibernate.SQL - 
    select
        r1_0.user_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        p1_0.role_id,
        p1_1.id,
        p1_1.action,
        p1_1.created_at,
        p1_1.description,
        p1_1.resource 
    from
        user_management.user_roles r1_0 
    join
        user_management.roles r1_1 
            on r1_1.id=r1_0.role_id 
    left join
        user_management.role_permissions p1_0 
            on r1_1.id=p1_0.role_id 
    left join
        user_management.permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        r1_0.user_id=?
22:45:47.584 [http-nio-8081-exec-1] DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.action,
        p1_1.created_at,
        p1_1.description,
        p1_1.resource 
    from
        user_management.role_permissions p1_0 
    join
        user_management.permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
22:45:47.841 [http-nio-8081-exec-1] DEBUG org.hibernate.SQL - 
    select
        t1_0.id,
        t1_0.created_at,
        t1_0.is_active,
        t1_0.name,
        t1_0.stripe_customer_id,
        t1_0.subdomain,
        t1_0.subscription_tier,
        t1_0.updated_at 
    from
        public.tenants t1_0 
    where
        t1_0.id=?
22:45:47.881 [http-nio-8081-exec-1] DEBUG org.hibernate.SQL - 
    update
        user_management.users 
    set
        email=?,
        first_name=?,
        is_active=?,
        last_login=?,
        last_name=?,
        password_hash=?,
        phone=?,
        tenant_id=?,
        updated_at=? 
    where
        id=?
22:45:47.909 [http-nio-8081-exec-3] DEBUG o.s.security.web.FilterChainProxy - Securing GET /users
22:45:47.922 [http-nio-8081-exec-3] DEBUG o.s.security.web.FilterChainProxy - Secured GET /users
22:45:47.923 [http-nio-8081-exec-3] DEBUG o.s.s.a.m.AuthorizationManagerBeforeMethodInterceptor - Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.crm.userservice.controller.UserController.getAllUsers(jakarta.servlet.http.HttpServletRequest); target is of class [com.crm.userservice.controller.UserController]
22:45:47.928 [http-nio-8081-exec-3] DEBUG o.s.s.a.m.AuthorizationManagerBeforeMethodInterceptor - Failed to authorize ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.crm.userservice.controller.UserController.getAllUsers(jakarta.servlet.http.HttpServletRequest); target is of class [com.crm.userservice.controller.UserController] with authorization manager org.springframework.security.config.annotation.method.configuration.DeferringObservationAuthorizationManager@7d5534d and decision ExpressionAuthorizationDecision [granted=false, expressionAttribute=hasAnyRole('ADMIN', 'SUPERVISOR')]
22:45:47.929 [http-nio-8081-exec-3] ERROR c.c.c.e.GlobalExceptionHandler - Access denied: Access Denied
23:07:08.435 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
23:07:08.447 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
23:07:08.449 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
